#!
# Initializes a git repo and sets up commit mails to development@viaboxx.de
if [ $# -ne 1 ] || [[ $1 != *.git ]]
then
  echo "Usage: `basename $0` {repoName.git}"
  exit 65
fi

echo "Initizaliting bare repo $1"
git init --bare $1

cd $1
echo "Setting up commit mails.."
ln -sf /var/git/global-hooks/post-receive-email hooks/post-receive
git config --add hooks.mailinglist "felix.dahlke@viaboxx.de,flurfunk@viaboxx.de,roman.stumm@viaboxx.de,sebastian.schuth@viaboxx.de,simon.tiffert@viaboxx.de,thomas.nicolaisen@viaboxx.de,flurfunk@viaboxx.de"

echo "Setting up hook so jenkins will be notified of pushes (you still need to configure SCM polling, for example @yearly)."
ln -sf /var/git/global-hooks/post-update-trigger-jenkins-git-jobs hooks/post-update

echo "TODO: Describe. To checkout, do git clone git@viaboxxsystems.de:$1" > description

sensible-editor description
